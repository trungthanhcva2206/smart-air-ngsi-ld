/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @Project smart-air-ngsi-ld
 * @Authors 
 *    - TT (trungthanhcva2206@gmail.com)
 *    - Tankchoi (tadzltv22082004@gmail.com)
 *    - Panh (panh812004.apn@gmail.com)
 * @Copyright (C) 2025 TAA. All rights reserved
 * @GitHub https://github.com/trungthanhcva2206/smart-air-ngsi-ld
 */
spring.application.name=smartair

# Server Configuration
server.port=8081

# Logging Configuration
logging.level.root=INFO
logging.level.org.opensource.smartair=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.springframework.boot=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Console Log Pattern (Spring Boot standard with colors)
logging.pattern.console=%clr(%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX}){faint} %clr(%5p) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n%wEx

# File Log Pattern (optional - if you want to log to file)
# logging.pattern.file=%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX} %5p ${PID:- } --- [%t] %-40.40logger{39} : %m%n
# logging.file.name=logs/smartair.log
# logging.file.max-size=10MB
# logging.file.max-history=30

# WebFlux Configuration
spring.http.codecs.max-in-memory-size=10MB

# Orion-LD Configuration
orion.url=http://localhost:1026
orion.tenant=hanoi
orion.service-path=/

# QuantumLeap Configuration
quantumleap.url=http://localhost:8668
quantumleap.fiware-service=hanoi
quantumleap.service-path=/
quantumleap.query.delay.seconds=2
# Number of data points to retrieve (30 days * 24 hours = 720 if hourly)
quantumleap.query.lastN=720

# WebClient timeout settings (milliseconds)
spring.webflux.client.connect-timeout=10000
spring.webflux.client.read-timeout=30000
spring.webflux.client.write-timeout=30000

# Reactor Netty pool settings
spring.reactor.netty.pool.max-connections=50
spring.reactor.netty.pool.max-idle-time=20s

# Backend URL (for Orion-LD subscriptions callback)
# Use localhost for development, change to actual host/IP in production
# Docker: http://backend:8081
# Local: http://localhost:8081
backend.url=http://host.docker.internal:8081

# MySQL Database Configuration (JPA)
spring.datasource.url=jdbc:mysql://localhost:3306/smartair_db?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Ho_Chi_Minh
spring.datasource.username=smartair
spring.datasource.password=smartair2024
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

# Email Configuration (Gmail SMTP)
# To get Gmail App Password: https://myaccount.google.com/security -> 2-Step Verification -> App passwords
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=your-email@gmail.com
spring.mail.password=your-gmail-app-password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# Email Template Configuration
# Display name shown in email client (can be customized)
mail.from-name=AirTrack - Hanoi Air Quality Alert System

# Frontend URL (used in email links)
# Default: http://localhost:5137 if not configured
app.frontend.url=http://localhost:5137

# Notification Configuration
# Minimum time interval between two alert emails (minutes)
# Default: 180 minutes (3 hours) - prevents email spam when devices send data continuously
notification.alert.throttle.minutes=180

# JWT Configuration
# Secret key for JWT signing (CHANGE THIS IN PRODUCTION!)
jwt.secret=your-256-bit-secret-key-change-this-in-production-environment-make-it-long-and-random
# JWT expiration time (milliseconds) - 24 hours
jwt.expiration=86400000

# Springdoc OpenAPI Configuration
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.layout=BaseLayout
# Only show Open Data API endpoints in Swagger UI
springdoc.packagesToScan=org.opensource.smartair.controllers
springdoc.pathsToMatch=/api/open/**